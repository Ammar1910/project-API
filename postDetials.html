<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        <link rel="stylesheet" href="./node_modules/bootstrap/dist/css/bootstrap.min.css">
        <script src="./node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
        <script src="./node_modules/axios/dist/axios.min.js"></script>
    
        <style>
            body{
                background-color: #f0ecff;
            }
            .card{
                margin-top: 20px;
            }
        </style>
    </head>
<body>
    
    <div id="danger-alert" class="fade show"  style="position: fixed; z-index: 999999; width: 30%; bottom: 0; right: 0;"></div>
    
    <div id="success-alert" class="fade show"  style="position: fixed; z-index: 999999; width: 30%; bottom: 0; right: 0;"></div>
    <div class="modal fade" id="login_modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5" id="exampleModalLabel">LOGIN</h1>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form>
                <div class="mb-3">
                  <label for="recipient-name" class="col-form-label">USER NAME</label>
                  <input type="text" class="form-control" id="recipient-name" value="santa">
                </div>
                <div class="mb-3">
                  <label  class="col-form-label" for="recipient-password">PASSWORD</label>
                  <input type="password" class="form-control" id="recipient-password" value="000111">
                </div>
              </form>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">CLOSE</button>
              <button type="button" class="btn btn-primary"  onclick="btnLogin()">LOGIN</button>
            </div>
          </div>
        </div>
    </div>
    <div class="modal fade" id="register_modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5" id="exampleModalLabel">REGISTER A NEW USER</h1>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form>
                <div class="mb-3">
                  <label for="register-recipient-name" class="col-form-label">USER NAME</label>
                  <input type="text" class="form-control" id="register-recipient-name" >
                </div>
                <div class="mb-3">
                    <label for="register-recipient-n" class="col-form-label">NAME</label>
                    <input type="text" class="form-control" id="register-recipient-n" >
                  </div>
                <div class="mb-3">
                  <label  class="col-form-label" for="register-recipient-password">PASSWORD</label>
                  <input type="password" class="form-control" id="register-recipient-password">
                </div>
                <div class="mb-3">
                  <label for="recipient-image-for-reg" class="col-form-label">IMAGE</label>
                  <input type="file" class="form-control" id="recipient-image-for-reg">
                </div>
              </form>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">CLOSE</button>
              <button type="button" class="btn btn-primary"  onclick="registerBtn()">REGISTER</button>
            </div>
          </div>
        </div>
    </div>   
    <div class="container pt-2">
        <div class="d-flex justify-content-center">
            <div class="col-9">
                <nav class="navbar navbar-expand-lg bg-body-tertiary rounded shadow ">
                    <div class="container-fluid">
                      <a class="navbar-brand" href="#">AURA</a>
                      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                      </button>
                      <div class="collapse navbar-collapse" id="navbarNav">
                        <ul class="navbar-nav">
                          <li class="nav-item">
                            <a class="nav-link active" aria-current="page" href="#">Home</a>
                          </li>
                          <li class="nav-item">
                            <a class="nav-link" href="#">Profile</a>
                          </li>
                        </ul>
                        <!--NON LOGGED IN  -->
                        <div id="div-log" class="d-flex w-100 justify-content-end" >
                            <button id="log-btn" type="button" class="btn btn-outline-success mx-2 " data-bs-toggle="modal" data-bs-target="#login_modal">LOGIN</button>
                            <button id="reg-btn" type="button" class="btn btn-outline-success" data-bs-toggle="modal" data-bs-target="#register_modal">REGISTER</button>
                        </div>
                        <!--//NON LOGGED IN  //-->
                        <!--FOR LOGGED IN  -->

                        <div id="div-logout" class="d-flex w-100 justify-content-end">
                            <img src="./1.png" alt="" id="user-UI-img" style="width: 40px; height: 40px; " class="rounded-circle">
                            <b id="user-UI-name" style="font-size: 22px; margin-left: 4px; margin-right: 4px;">@santa</b>
                            <!-- <span id="user-UI-name" style="font-size: 22px; margin-left: 4px; margin-right: 4px;"></span> -->
                            <button id="logout-btn" type="button" class="btn btn-outline-danger" onclick="logOut()">LOG OUT</button>

                        </div>
                        <!--//FOR LOGGED IN  //-->


                      </div>
                    </div>
                </nav>
            </div>
        </div>
    </div>
    <!-- MAIN CONTENT -->
    <div class="container" style="height: 1000px;">
            <!-- USER,S POSTS -->
            <div class="d-flex justify-content-center mt-4">
                    <div class="col-9">
                        <span id="name-author" style="font-size: 40px; text-transform: capitalize;">santa</span>
                        <span style="font-size: 40px;">posts</span>
                        <div class="card shadow">
                            <div class="card-header">
                              <img src="./1.png" alt="" style="width: 40px; height: 40px; " class="rounded-circle">
                              <span><b>SANTA</b></span>
                            </div>
                            <div class="card-body">
                                <img src="./2.png" alt="" style="width: 800px; height: 400px; margin-left: 60px;" id="image-for-user-post">
                                <h6 style="color: gray; margin-left: 70px; font-size: 20px;" class="mt-2">2 min ago</h6>
                                <h5 style="margin-left: 70px;">Lorem ipsum dolor sit amet consectetur adipisicing elit. Explicabo, atque.</h5>
                                <hr>
                                <div style="margin-left: 70px;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil" viewBox="0 0 16 16">
                                        <path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325"/>
                                    </svg>
                                    <span>
                                        (3) Comments
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                    
             </div>
                    <!--// post// -->
    </div>
</body>
<script src="./mainlogic.js"></script>
<!-- <script>
        UISetUp()
        function UISetUp(){
        const checkToken = localStorage.getItem("token")
        const loginBtn = document.getElementById("log-btn")
        const regBtn = document.getElementById("reg-btn")
        const logoutBtn = document.getElementById("div-logout")
        const loginDiv = document.getElementById("div-log")
        const postbtnDisplay = document.getElementById("addPost");


        
        if(checkToken == null){
            logoutBtn.style.setProperty("display","none","important")
            
            loginDiv.style.setProperty("display","flex","important")
            postbtnDisplay.style.setProperty("display", "none", "important");
            // loginBtn.style.setProperty("display","block","important") 
            // regBtn.style.setProperty("display","block","important")
        }else{
            
            loginDiv.style.setProperty("display","none","important")
            
            // loginBtn.style.setProperty("display","none","important") 
            // regBtn.style.setProperty("display","none","important")
            logoutBtn.style.setProperty("display","flex","important")
            postbtnDisplay.style.setProperty("display", "block", "important");
            //
            const user = getCurrentUser()
            document.getElementById("user-UI-name").innerHTML = user.username
            document.getElementById("user-UI-img").src = user.profile_image

            


        }   
    }
    function registerBtn(){
        const name = document.getElementById("register-recipient-n").value
        const image = document.getElementById("recipient-image-for-reg").files[0]
        const password = document.getElementById("register-recipient-password").value
        const username = document.getElementById("register-recipient-name").value
        console.log(name,username ,password)
        // const params = {
        // "username" : username,
        // "password" : password,
        // "name" : name
        // }
        const formData = new FormData()
        formData.append("username", username) 
        formData.append("password", password) 
        formData.append("name", name) 
        formData.append("image", image) 
        const headers = {
          "Content-Type":"multipart/form-data",
        }

        axios.post("https://tarmeezacademy.com/api/v1/register",formData,{
          headers: headers
        })
        .then((response) => {
            console.log(response.data)
            localStorage.setItem("token", response.data.token )
            localStorage.setItem("user",JSON.stringify(response.data.user.username))
            const modal = document.getElementById("register_modal")
            const modalInstance = bootstrap.Modal.getOrCreateInstance(modal);
            
            modalInstance.hide()
            showAllAlerts("Register successfully completed","success")
            UISetUp()
        }).catch((error) => {
          const message = error.response.data.message
            //console.log(error.response.data.message)
            showAllAlerts(message,"danger")
        })
    }
    function btnLogin(){
        const password = document.getElementById("recipient-password").value
        const username = document.getElementById("recipient-name").value
        const params = {
        "username" : username,
        "password" : password
        }
        axios.post("https://tarmeezacademy.com/api/v1/login",params)
        .then((response) => {
            localStorage.setItem("token", response.data.token )
            localStorage.setItem("user",JSON.stringify(response.data.user.username))
            const modal = document.getElementById("login_modal")
            const modalInstance = bootstrap.Modal.getOrCreateInstance(modal);
            
            modalInstance.hide()
            showAllAlerts("Login successfully completed","success")
            UISetUp()
        }).catch((error) => {
            const message = error.response.data.message
            //console.log(error.response.data.message)
            showAllAlerts(message,"danger")
        })

        
    }
    function logOut(){
        localStorage.removeItem("token")
        localStorage.removeItem("user")
        UISetUp()
        showAllAlerts("Logout successfully completed","success")

    }
    function showAllAlerts(message,type){
        const alertPlaceholder = document.getElementById('success-alert')
        const alert = (message, type) => {
        const wrapper = document.createElement('div')
        wrapper.innerHTML = [
            `<div class="alert alert-${type} alert-dismissible" role="alert">`,
            `   <div>${message}</div>`,
            '   <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>',
            '</div>'
        ].join('')

        alertPlaceholder.append(wrapper)
        }


            alert(message, type)
            setTimeout(() => {
                const alertClose = bootstrap.Alert.getOrCreateInstance('#success-alert')
                alertClose.dispose()
            }, 2000)

        
        
    }
    btnLogin()
</script> -->
<script>
    UISetUp()

    // الحصول على الرابط الحالي
// const currentUrl = window.location.href;
// // إنشاء كائن URL
// const url = new URL(currentUrl);

// // استخراج الـ query parameters باستخدام searchParams
// const params = new URLSearchParams(url.search);

// // طباعة جميع الـ query parameters
// params.forEach((value, key) => {
//     console.log(`${key}: ${value}`);
// });

// // أو استخراج قيمة معينة
// const paramValue = params.get('postId','image','body'); // استبدل 'paramName' باسم الـ query parameter الذي تريد استخراجه
// console.log(postId,image,body);
const urlParams = new URLSearchParams(window.location.search)
const id =  urlParams.get("postId")
console.log(id)
function getPost(){



      axios.get(`https://tarmeezacademy.com/api/v1/posts?limit=1&${34606}`)
    .then((response) => {
      // document.getElementById("name-author").innerHTML = ""
      // document.getElementById("image-for-user-post").src =  "" 
        console.log(response.data.data)
        const post = response.data.data
        const comments = post.comments
        const author = post[0].author 
        const image = post[0].image
        console.log(author)   
        document.getElementById("name-author").innerHTML = author.username
 
    })

    }

    getPost()

</script>
</html>